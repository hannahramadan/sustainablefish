<!doctype html>
<html lang = "en">
  <head>
    <link rel="icon" href="data:,">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>
    Species Details
    </title>
    <script
    src="https://code.jquery.com/jquery-3.4.1.js"
    integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
    crossorigin="anonymous"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="static/styles.css" type="text/css">
  </head>

  <body>
<!-- Header -->
<nav class="navbar fixed-top navbar-expand navbar-light" style="background-color: #ffffff;">
  <div class="container-fluid">
    <img src="https://www.sustainableseafoodcoalition.org/wp-content/uploads/sustainable_fish_cycle.png"width="40" height="40" padding="5%">
    <a class="navbar-brand" >Sustainable Seafood</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link active" aria-current="page" href="/search"><b>Search</b></a></li>
        <li class="nav-item"><a class="nav-link active" aria-current="page" href="/species"><b>Explore Species</b></a></li>
        <li class="nav-item"><a class="nav-link active" aria-current="page" href="/watchlist"><b>My Watchlist</b></a></li>
        <li class="nav-item"><a class="nav-link active" aria-current="page" href="/shoplocal"><b>Shop Local</b></a></li>
        <li class="nav-item"><a class="nav-link active" aria-current="page" href="/game"><b>Quiz</b></a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="nav-item"><a class="nav-link active" aria-current="page" href="/profile">Profile</a></li>
        <li class="nav-item"><a class="nav-link active" aria-current="page" method = "POST" href="/logout">Log out</a></li>
      </ul>
    </div>
  </div>
</nav>

<div
    class="p-5 text-center bg-image"
    style="
    background: linear-gradient(to top, #001F54, #034078);
    height: 200px;
    "
    >
<div class="mask">
  <div class="d-flex justify-content-center align-items-center">
    <div class="text-white">
      <h2 class="mb-3">{{species_name}}</h2>
      <h5 class="mb-3"><i>{{scientific_name|safe}}</i></h5>
    </div>
  </div>
</div>
</div>

<div class="container">
    <div class="csscenter" style="padding-right: 50px; padding-left:50px;">
        <div class="container"style="padding-top: 50px;">
            <div class="row">
              <div class="col">
                <img src="{{ img }}" alt="{{fish.name}}" style="width: 30rem; max-height: 30rem;">
                <br>
                <br>
                <br>
                <div class="card-body">   
                        <p class="card-text"><b>Region:</b> {{species_region}}</p>
                        <p class="card-text"><b>Population:</b> {{population}}</p>
                        <p class="card-text"><b>Habitat impacts:</b> {{habitat_impacts}}</p>
                        <p class="card-text"><b>Population Status:</b> {{population_status|safe}}</p> 
                </div>
              </div>
              <div class="col justify-content-end">
                <h5>Sustainability Score: <b>{{score}}</b></h5>
                <p class="card-text">Watched by <b>{{likes}}</b> people</p>
                {% if fish in favorites %}
                <form id="favorite" action='/favorite_fish/{{fish.fish_id}}' method='POST' >
                        <button type="button" id='fave{{fish.fish_id}}' class="btn btn-outline-primary" name = "{{fish.fish_id}}" value = "{{fish.fish_id}}" class="card-link">Remove from watchlist</button>
                </form>       
                    {% else %}          
                <form id="favorite" action='/favorite_fish/{{fish.fish_id}}' method='POST' >
                        <button type="button" id='fave{{fish.fish_id}}' class="btn btn-outline-primary" name = "{{fish.fish_id}}" value = "{{fish.fish_id}}" class="card-link">Add to watchlist</button>
                    {% endif %} 
                </form>
              </div>
            </div>
          </div>

</div>

<!-- Script to handle watchlist button -->
<script>
    $(`#fave{{fish.fish_id}}`).on('click', (evt) => {
        evt.preventDefault();
        fish_id = $(`#fave{{fish.fish_id}}`).val()
        $.post("favorite_fish/{{fish.fish_id}}", fish_id, (res) =>{
            $(`#fave{{fish.fish_id}}`).html(res)
            location.reload()
        });
    });
</script>



  </body>
</html>


